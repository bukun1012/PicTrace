{% load static %}
<!-- Header -->
<header class="sticky top-0 left-0 z-50 w-full bg-black shadow-md h-14">
  <div class="flex items-center justify-between h-full px-4 mx-auto max-w-7xl">
    <!-- Left Section: Logo -->
    <div class="flex items-center space-x-2">
      <a href="{% url 'home:home' %}" class="flex items-center space-x-2">
        <img
          src="{% static 'images/logo.png' %}"
          alt="PicTrace Logo"
          class="rounded-full"
          style="width: 40px; height: 40px"
        />
        <span class="text-xl font-semibold text-white">PicTrace</span>
      </a>
    </div>

    <!-- Center Section: Navigation -->
    <nav>
      <ul class="flex space-x-6">
        <li><a href="/" class="text-white hover:underline">首頁</a></li>
        <li>
          <a href="/features" class="text-white hover:underline">功能</a>
        </li>
        <li>
          <a href="/contact" class="text-white hover:underline">聯絡我們</a>
        </li>
      </ul>
    </nav>

    <!-- Right Section: User Menu -->
    <div class="relative flex items-center space-x-4">
      {% if user.is_authenticated %}
      <!-- User Avatar + Dropdown -->
      <div class="relative">
        <button onclick="toggleDropdown()" class="focus:outline-none">
          {% if user.profile.avatar %}
          <img
            src="{{ user.profile.avatar }}"
            alt="User Avatar"
            class="rounded-full cursor-pointer"
            style="width: 40px; height: 40px"
          />
          {% else %}
          <img
            src="{% static 'images/user-avatar.png' %}"
            alt="User Avatar"
            class="rounded-full cursor-pointer"
            style="width: 40px; height: 40px"
          />
          {% endif %}
        </button>

        <!-- Dropdown Menu -->
        <div
          id="userDropdown"
          class="absolute right-0 z-10 hidden w-48 py-2 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg"
        >
          <a
            href="{% url 'users:profile' %}"
            class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
          >
            個人資料
          </a>
          <a
            href="#"
            class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
          >
            設定
          </a>
          <form action="{% url 'users:logout' %}" method="POST">
            {% csrf_token %}
            <button
              type="submit"
              class="block w-full px-4 py-2 text-sm text-left text-gray-700 hover:bg-gray-100"
            >
              登出
            </button>
          </form>
        </div>
      </div>
      {% else %}
      <!-- 登入按鈕 -->
      <a
        href="{% url 'users:login' %}"
        class="px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-200"
      >
        登入
      </a>
      {% endif %}
    </div>
  </div>
</header>

<!-- JavaScript -->
<script>
  // 顯示或隱藏下拉選單
  function toggleDropdown() {
    const dropdown = document.getElementById("userDropdown");
    dropdown.classList.toggle("hidden");
  }

  // 點擊其他地方時隱藏下拉選單
  function closeDropdown(event) {
    const dropdown = document.getElementById("userDropdown");
    const userMenu = document.querySelector(".relative"); // 大頭貼的父元素

    // 檢查點擊位置是否在大頭貼或下拉選單範圍內
    if (!userMenu.contains(event.target) && !dropdown.contains(event.target)) {
      dropdown.classList.add("hidden");
    }
  }

  // 設置點擊頁面其他地方時觸發關閉下拉選單
  document.addEventListener("click", closeDropdown);
</script>
